function addRow(e,t){e=Grid.Id;var r=document.getElementById(e),a=r.firstChild;if(a.rows.length>=dataSource.length)return void clearTimeout(myVar);try{for(var n=t;t+30>n;n++){var i=a.rows.length;if(void 0==dataSource[n])return Grid.Pager(e,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(currentPage),void clearTimeout(myVar);for(var o=a.insertRow(i),d=0;d<columnData.length;d++){var l=o.insertCell(d);columnData[d]==ColmName?l.innerHTML="<a href="+baseUrl+dataSource[n][SourceCol]+">"+dataSource[n][columnData[d]]+"</a>":l.innerHTML=dataSource[n][columnData[d]]}}Grid.Pager(e,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(currentPage)}catch(s){alert(s)}}function sortByKey(e,t){return e.sort(function(e,r){var a=e[t],n=r[t];return n>a?-1:a>n?1:0})}function RevsortByKey(e,t){return e.reverse()}function sColm(e){var t=$("#"+Grid.Id+" th").eq(e);clearInterval(myVar),clearTimeout(myVar),document.getElementById(Grid.Id).innerHTML="",document.getElementById("pageNavPosition").innerHTML="";var r=Grid.CreateGrid(Grid.Id,cssName);Grid.SetColumnHeader(r,colgrpName),Grid.setData(JsonData),Grid.SetPaging(tableId,PageSize),Grid.SetHyperLink(ColmName,baseUrl,SourceCol),void 0!=sortArr&&sortArr.length>0&&t.text()!=sortArr[1]&&(sortArr=""),void 0!=sortArr&&sortArr.length>0?(t=$("#"+Grid.Id+" th").eq(sortArr[0]),t[0].scope=sortArr[2]):t=$("#"+Grid.Id+" th").eq(e),""==t[0].scope?(dataSource.sort(sort_by(t.text(),!1,function(e){return e})),t[0].scope="asc",t[0].innerHTML+="<img src='./Images/asc.jpg' alt='' style='height:15px;width:15px;'>"):"asc"==t[0].scope?(dataSource.sort(sort_by(t.text(),!0,function(e){return e})),t[0].scope="desc",t[0].innerHTML+="<img src='./Images/desc.jpg' alt='' style='height:15px;width:15px;'>"):"desc"==t[0].scope&&(dataSource.sort(sort_by(t.text(),!1,function(e){return e})),t[0].scope="asc",t[0].innerHTML+="<img src='./Images/asc.jpg' alt='' style='height:15px;width:15px;'>"),sortArr=[e,t.text(),t[0].scope],Grid.Bind(),Grid.Pager(Grid.Id,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),Grid.isDomReady()}function getObjects(e,t,r){var a=[];for(var n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?a=a.concat(getObjects(e[n],t,r)):n==t&&e[n]==r||n==t&&""==r?a.push(e):e[n]==r&&""==t&&-1==a.lastIndexOf(e)&&a.push(e));return a}function SearchGrid(){var e=[];if($("#txtSearch").val().length>3){dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var t in dataSource){var r=dataSource[t],a=JSON.stringify(r);a.toLowerCase().indexOf($("#txtSearch").val().toLowerCase())>0&&e.push(r)}if(e.length>0){dataSource=e,clearInterval(myVar),clearTimeout(myVar),document.getElementById(Grid.Id).innerHTML="",document.getElementById("pageNavPosition").innerHTML="";var n=Grid.CreateGrid(Grid.Id,cssName);Grid.SetColumnHeader(n,colgrpName),Grid.SetPaging(tableId,PageSize),Grid.SetHyperLink(ColmName,baseUrl,SourceCol),Grid.Bind(),Grid.Pager(Grid.Id,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),Grid.isDomReady()}}else 0==$("#txtSearch").val().length&&Grid.Reset()}var sortArr,myVar,hdnHtml,columnData,dataSource,hiddendt,columnHeadingHtml,currentPage=1,tableId,PageSize,baseUrl,SourceCol,ColmName,colgrpName,cssName,ReportTitle,Grid={Id:"",CreateGrid:function(e,t){var r=document.getElementById(e);return e+="1",cssName=t,r.innerHTML="<table id="+e+" class='"+t+"'>"},SetColumnHeader:function(e,t){var r=e;colgrpName=t;for(var a=t.split(","),n=0;n<a.length;n++)r+=2==n?"<th data-th='Customer Details' onclick=sColm("+n+"); ><span>"+a[n]+"</span></th>":"<th onclick=sColm("+n+"); >"+a[n]+"</th>";if(r+="</tr></table>",document.getElementById(Grid.Id).innerHTML=r,hdnHtml=r,columnHeadingHtml=r,columnData=a,null==document.getElementById("filterExport")){var i='"Customer_Details_Report"',o="<div id='filterExport' ><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:right; text-align:center'><a id='lnkExprt' class='export' target=_blank' onclick='Grid.ExportCSV(this,"+i+", true);'>Export </a></div><div class='FilterDiv' id='dvFilter'><div style='position:relative;min-height:1px;padding-left:15px; float:left; text-align:center'>Search: <input type='text' id='txtSearch' onkeyup='SearchGrid();'/></div><div style='position:relative;min-height:1px;padding-left:15px; float:left; text-align:center'>Columns:</div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'> <select id='slCols'></select> </div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'> <select id='slopCols'><option >equal</option><option >Not equal</option></select> </div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'><input id='opVal' type='text /></div><div style='position:relative;min-height:1px;padding-left:15px; float:left; text-align:center'><input type='button' value='Apply' onclick='Grid.Filter();' />&nbsp;<input type='button' value='Reset' onclick='Grid.Reset();' /></div></div></div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'><input id='opVal' type='text /></div>";$(o).insertBefore("#"+Grid.Id),$.each(a,function(e,t){$("#slCols").append($("<option></option>").attr("value",e).text(t))})}},Reset:function(){clearInterval(myVar),clearTimeout(myVar),document.getElementById(Grid.Id).innerHTML="",document.getElementById("pageNavPosition").innerHTML="";var e=Grid.CreateGrid(Grid.Id,cssName);Grid.SetColumnHeader(e,colgrpName),Grid.setData(hiddendt),Grid.SetPaging(tableId,PageSize),Grid.SetHyperLink(ColmName,baseUrl,SourceCol),Grid.Bind(),Grid.Pager(Grid.Id,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),Grid.isDomReady()},Filter:function(){var e=document.getElementById("slCols");if(-1==e.selectedIndex)return null;var t=e.options[e.selectedIndex].text,r=document.getElementById("slopCols");if(-1==r.selectedIndex)return null;var a=[],n=r.options[r.selectedIndex].text;if("equal"==n){var i=t,o=document.getElementById("opVal").value;dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var d=0;d<dataSource.length;d++)NaN==parseInt(dataSource[d][i])?dataSource[d][i].toLowerCase()==o.toLowerCase()&&a.push(dataSource[d]):dataSource[d][i]==o&&a.push(dataSource[d])}else if("Not equal"==n){var i=t,o=document.getElementById("opVal").value;dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var d=0;d<dataSource.length;d++)NaN==parseInt(dataSource[d][i])?dataSource[d][i].toLowerCase()!=o.toLowerCase()&&a.push(dataSource[d]):dataSource[d][i]!=o&&a.push(dataSource[d])}if(a.length>0){dataSource=a,clearInterval(myVar),clearTimeout(myVar),document.getElementById(Grid.Id).innerHTML="",document.getElementById("pageNavPosition").innerHTML="";var l=Grid.CreateGrid(Grid.Id,cssName);Grid.SetColumnHeader(l,colgrpName),Grid.SetPaging(tableId,PageSize),Grid.SetHyperLink(ColmName,baseUrl,SourceCol),Grid.Bind(),Grid.Pager(Grid.Id,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),Grid.isDomReady()}},sort:function(e){dataSource=sortByKey(dataSource,e)},setData:function(e){hiddendt=e,dataSource=e},show_hide_column:function(e,t){for(var r=document.getElementById(Grid.Id),a=r.getElementsByTagName("tr"),n=0;n<a.length;n++){var i=a[n].children;if(e>=0&&e<i.length){var o=i[e];"TD"==o.tagName&&(o.style.display=t?"block":"none")}}var d=r.getElementsByTagName("th")[e];d&&(d.style.display=t?"block":"none")},BindExtraRow:function(){bindGrid()},isDomReady:function(){var e=document.getElementById(Grid.Id),t=e.firstChild;if(t.rows.length>=dataSource.length)return void clearInterval(myVar);if(null!=t&&t.rows.length>98){for(var r=0;r<t.rows.length;r++);myVar=setInterval(function(){addRow(Grid.Id,t.rows.length)},1e3)}},SetPaging:function(e,t){tableId=e,PageSize=t},Bind:function(){var e,t=document.getElementById(Grid.Id),r=t.firstChild;e=dataSource.length<100?dataSource.length:100;for(var a=0;e>a;a++)for(var n=r.rows.length,i=r.insertRow(n),o=0;o<columnData.length;o++){var d=i.insertCell(o);columnData[o]==ColmName?d.innerHTML="<a href="+baseUrl+dataSource[a][SourceCol]+">"+dataSource[a][columnData[o]]+"</a>":d.innerHTML=dataSource[a][columnData[o]]}Grid.Pager(tableId,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1)},SetHyperLink:function(e,t,r){baseUrl=t,SourceCol=r,ColmName=e},HyperLink:function(e,t,r,a){for(var n,i=document.getElementById(Grid.Id).firstChild.getElementsByTagName("th"),o=0;o<i.length;o++)if(i[o].innerHTML.trim()==SourceCol.trim()&&(n=i[o].cellIndex),i[o].innerHTML.trim()==ColmName.trim())for(var d=document.getElementById(Grid.Id).firstChild.getElementsByTagName("tr"),l=0;l<d.length;l++){var s,c=d[l].cells,g=c[i[o].cellIndex].innerHTML;"th"!=c[i[o].cellIndex].localName&&(s=void 0!=n?"<a href="+t+c[n].innerHTML+">"+g+"</a>":"<a href="+t+a+">"+g+"</a>",c[i[o].cellIndex].innerHTML="",c[i[o].cellIndex].innerHTML=s)}},SetExportFileName:function(e){ReportTitle=e},ExportCSV:function(e,t,r){var a,n=dataSource;a="object"!=typeof n?JSON.parse(n):n;var i="";if(i+=ReportTitle+"\r\n\n",r){var o="";for(var d in a[0])o+=d+",";o=o.slice(0,-1),i+=o+"\r\n"}for(var l=0;l<a.length;l++){var o="";for(var d in a[l])o+='"'+a[l][d]+'",';o.slice(0,o.length-1),i+=o+"\r\n"}if(""==i)return void alert("Invalid data");var s=ReportTitle.replace(/ /g,"_"),c=("data:text/csv;charset=utf-8,"+escape(i),new Blob([i],{type:"text/csv"}));if(navigator.msSaveBlob)navigator.msSaveOrOpenBlob(c,s+".csv");else{var g=URL.createObjectURL(c);e.href=g,e.download=s+".csv"}},Pager:function(e,t){this.tableName=e,this.itemsPerPage=t,this.pages=0,this.inited=!1,this.showRecords=function(t,r){for(var a=document.getElementById(e).getElementsByTagName("tr"),n=1;n<a.length;n++)t>n||n>r?a[n].style.display="none":a[n].style.display=""},this.showPage=function(e){if(!this.inited)return void alert("not inited");var r=document.getElementById("pg"+currentPage);(null!=r||void 0!=r)&&(r.className="pg-normal"),currentPage=e;var a=document.getElementById("pg"+currentPage);(null!=a||void 0!=a)&&(a.className="pg-selected");var n=(e-1)*t+1,i=n+t-1;this.showRecords(n,i)},this.prev=function(){currentPage>1&&(this.showPage(currentPage-1),document.getElementById("pgNum").innerHTML="",document.getElementById("pgNum").innerHTML=" Page Number: "+currentPage+" <span> <span>  Total Records: "+dataSource.length+"</span></span>")},this.next=function(){currentPage<this.pages&&this.showPage(currentPage+1),document.getElementById("pgNum").innerHTML="",document.getElementById("pgNum").innerHTML=" Page Number: "+currentPage+" <span> <span>  Total Records: "+dataSource.length+"</span></span>"},this.init=function(){var r=document.getElementById(e).getElementsByTagName("tr"),a=r.length-1;this.pages=Math.ceil(a/t),this.inited=!0},this.showPageNav=function(e,t){if(!this.inited)return void alert("not inited");for(var r=document.getElementById(t),a='<span onclick="Grid.prev();" class="pg-normal"> &#171 Prev </span> | ',n=1;n<=this.pages;n++)a+='<span id="pg'+n+'" class="pg-normal" onclick="'+e+".showPage("+n+');"></span>  ';a+='<span onclick="Grid.next();" class="pg-normal"> Next &#187;</span>',r.innerHTML=a,r.innerHTML+='<span id="pgNum"> Page Number: '+currentPage+"<span> <span >  Total Records: "+dataSource.length+"</span>"}},SetAjaxDetails:function(e,t,r){$.ajax({type:"POST",url:e,contentType:"application/json;charset=utf-8",dataType:"json",success:function(e){for(var t=document.getElementById(tId),r=t.firstChild,a=e.d,n=JSON.parse(a),o=r.rows.length,d=r.insertRow(o),l=0;l<columnData.length;l++){var s=d.insertCell(l);columnData[l]==ColmName?s.innerHTML="<a href="+baseUrl+n[i][SourceCol]+">"+n[i][columnData[l]]+"</a>":s.innerHTML=n[i][columnData[l]]}}})}};"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var sort_by=function(e,t,r){var a=r?function(t){return r(t[e])}:function(t){return t[e]};return t=t?-1:1,function(e,r){return e=a(e),r=a(r),t*((e>r)-(r>e))}};
