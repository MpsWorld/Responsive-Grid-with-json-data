function addRow(e,t){e=Grid.Id;var n=document.getElementById(e),i=n.firstChild;if(i.rows.length>=dataSource.length)return clearTimeout(myVar),void(myVar=null);try{for(var a=t;t+30>a;a++){var r=i.rows.length;if(void 0==dataSource[a])return Grid.Pager(e,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(currentPage),clearTimeout(myVar),void(myVar=null);var o=i.insertRow(r);$.each(columnData,function(e,t){var n=o.insertCell(e);t==ColmName?(n.innerHTML="<a href="+baseUrl+dataSource[a][SourceCol]+">"+dataSource[a][t]+"</a>",n.title=dataSource[a][t]):(n.innerHTML=dataSource[a][t],n.title=dataSource[a][t])})}Grid.Pager(e,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(currentPage),hideCols(),document.getElementById("loadingImg").style.display="none",document.getElementById("loadingImg").style.visibility="hidden"}catch(l){alert(l)}}function sortByKey(e,t){return e.sort(function(e,n){var i=e[t],a=n[t];return a>i?-1:i>a?1:0})}function RevsortByKey(e,t){return e.reverse()}function sColm(e){document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible";var t=$("#"+Grid.Id+" th").eq(e);clearInterval(myVar),clearTimeout(myVar),myVar=null,document.getElementById(Grid.Id).innerHTML="",document.getElementById("pageNavPosition").innerHTML="";var n=Grid.CreateGrid(Grid.Id,cssName);Grid.SetColumnHeader(n,colgrpName),Grid.setData(JsonData),Grid.SetPaging(tableId,PageSize),Grid.SetHyperLink(ColmName,baseUrl,SourceCol),void 0!=sortArr&&sortArr.length>0&&t.text()!=sortArr[1]&&(sortArr=""),void 0!=sortArr&&sortArr.length>0?(t=$("#"+Grid.Id+" th").eq(sortArr[0]),t[0].scope=sortArr[2]):t=$("#"+Grid.Id+" th").eq(e),""==t[0].scope?(dataSource.sort(sort_by(t.text(),!1,function(e){return e})),t[0].scope="asc",t[0].innerHTML+="<img src='./Images/sort_asc.png' alt='' style='height:20px;width:19px;'>"):"asc"==t[0].scope?(dataSource.sort(sort_by(t.text(),!0,function(e){return e})),t[0].scope="desc",t[0].innerHTML+="<img src='./Images/sort_desc.png' alt='' style='height:20px;width:19px;'>"):"desc"==t[0].scope&&(dataSource.sort(sort_by(t.text(),!1,function(e){return e})),t[0].scope="asc",t[0].innerHTML+="<img src='./Images/sort_asc.png' alt='' style='height:20px;width:19px;'>"),sortArr=[e,t.text(),t[0].scope],Grid.Bind(),Grid.Pager(Grid.Id,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),Grid.isDomReady()}function getObjects(e,t,n){var i=[];for(var a in e)e.hasOwnProperty(a)&&("object"==typeof e[a]?i=i.concat(getObjects(e[a],t,n)):a==t&&e[a]==n||a==t&&""==n?i.push(e):e[a]==n&&""==t&&-1==i.lastIndexOf(e)&&i.push(e));return i}function SearchGrid(){var e=[];if($("#txtSearch").val().length>1){document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible",dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var t in dataSource){var n=dataSource[t],i=JSON.stringify(n);i.toLowerCase().indexOf($("#txtSearch").val().toLowerCase())>0&&e.push(n)}e.length>0&&(dataSource=e,clearInterval(myVar),clearTimeout(myVar),myVar=null,CommCode())}else 0==$("#txtSearch").val().length&&(document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible",Grid.Reset())}function CommCode(){document.getElementById(Grid.Id).innerHTML="",document.getElementById("pageNavPosition").innerHTML="";var e=Grid.CreateGrid(Grid.Id,cssName);Grid.SetColumnHeader(e,colgrpName),Grid.SetPaging(tableId,PageSize),Grid.SetHyperLink(ColmName,baseUrl,SourceCol),Grid.Bind(),Grid.Pager(Grid.Id,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),Grid.isDomReady()}function chkbx(e){e.checked?(Grid.show_hide_column(e.id,!1),shideCol.push(e.id)):(Grid.show_hide_column(e.id,!0),shideCol.pop(e.id))}function hideCols(){for(var e=0;e<shideCol.length;e++)Grid.show_hide_column(shideCol[e],!1)}var sortArr,myVar,hdnHtml,columnData,dataSource,hiddendt,columnHeadingHtml,currentPage=1,tableId,PageSize,baseUrl,SourceCol,ColmName,colgrpName,cssName,ReportTitle,shideCol=[],Grid={Id:"",CreateGrid:function(e,t){document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible";var n=document.getElementById(e);return e+="1",cssName=t,n.innerHTML="<table id="+e+" class='"+t+"'>"},SetColumnHeader:function(e,t){var n=e;colgrpName=t;var i=t.split(",");if($.each(i,function(e,t){n+=2==e?"<th data-th='Customer Details' onclick=sColm("+e+"); ><span>"+t+"</span></th>":"<th onclick=sColm("+e+"); >"+t+"</th>"}),n+="</tr></table>",document.getElementById(Grid.Id).innerHTML=n,hdnHtml=n,columnHeadingHtml=n,columnData=i,null==document.getElementById("filterExport")){var a='"Customer_Details_Report"',r="<div id='filterExport' ><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:right; text-align:center'><a id='lnkExprt' class='export' target=_blank' onclick='Grid.ExportCSV(this,"+a+", true);'>Export </a></div><div class='FilterDiv' id='dvFilter'><div style='position:relative;min-height:1px;padding-left:15px; float:left; text-align:center'>Search: <input type='text' id='txtSearch' onkeyup='SearchGrid();'/></div><div style='position:relative;min-height:1px;padding-left:15px; float:left; text-align:center'>Columns:</div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'> <select id='slCols'></select> </div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'> <select id='slopCols'><option >equal</option><option >Not equal</option><option >Contains</option></select> </div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'><input id='opVal' type='text /></div><div style='position:relative;min-height:1px;padding-left:15px; float:left; text-align:center'><input type='button' value='Apply' onclick='Grid.Filter();' />&nbsp;<input type='button' value='Reset' onclick='Grid.Reset();' /></div></div></div><div style='position:relative;min-height:1px;padding-left:15px;padding-right:15px; float:left; text-align:center'><input id='opVal' type='text /></div>";$(r).insertBefore("#"+Grid.Id),$.each(i,function(e,t){$("#slCols").append($("<option></option>").attr("value",e).text(t))});var o="";$.each(i,function(e,t){o+="<label for="+e+"><input type='checkbox' onclick='chkbx(this);' id="+e+" />"+t+"</label>"});var l="<div class='multiselect'><div class='selectBox' onclick='showCheckboxes()'><select><option>Show Hide Columns</option></select><div class='overSelect'></div></div><div id='checkboxes'>"+o+"</div></div>";$(l).insertAfter("#dvFilter")}},Reset:function(){clearInterval(myVar),clearTimeout(myVar),myVar=null,dataSource.length!=hiddendt.length&&(dataSource=hiddendt),CommCode()},Filter:function(){document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible";var e=document.getElementById("slCols");if(-1==e.selectedIndex)return null;var t=e.options[e.selectedIndex].text,n=document.getElementById("slopCols");if(-1==n.selectedIndex)return null;var i=[],a=n.options[n.selectedIndex].text;if("equal"==a){var r=t,o=document.getElementById("opVal").value;dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var l=0;l<dataSource.length;l++)dataSource[l][r].toString().toLowerCase()==o.toLowerCase()&&i.push(dataSource[l])}else if("Contains"==a){dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var r=t,d=0;d<dataSource.length;d++)dataSource[d][r].toString().toLowerCase().indexOf(document.getElementById("opVal").value)>=0&&i.push(dataSource[d])}else if("Not equal"==a){var r=t,o=document.getElementById("opVal").value;dataSource.length!=hiddendt.length&&(dataSource=hiddendt);for(var l=0;l<dataSource.length;l++)dataSource[l][r].toString().toLowerCase()!=o.toLowerCase()&&i.push(dataSource[l])}i.length>0?(dataSource=i,clearInterval(myVar),clearTimeout(myVar),myVar=null,CommCode()):(document.getElementById("loadingImg").style.display="none",document.getElementById("loadingImg").style.visibility="hidden")},sort:function(e){dataSource=sortByKey(dataSource,e)},setData:function(e){hiddendt=e,dataSource=e},show_hide_column:function(e,t){for(var n=document.getElementById(Grid.Id),i=n.getElementsByTagName("tr"),a=0;a<i.length;a++){var r=i[a].children;if(e>=0&&e<r.length){var o=r[e];"TD"==o.tagName&&(t?o.style.display="":o.style.display="none")}}var l=n.getElementsByTagName("th")[e];l&&(t?l.style.display="":l.style.display="none")},BindExtraRow:function(){bindGrid()},isDomReady:function(){lnkExprt.style.display="block",document.getElementById("loadingImg").style.display="none",document.getElementById("loadingImg").style.visibility="hidden";var e=document.getElementById(Grid.Id),t=e.firstChild;return t.rows.length>=dataSource.length?(clearInterval(myVar),void(myVar=null)):(null!=t&&t.rows.length>98,void hideCols())},SetPaging:function(e,t){tableId=e,PageSize=t},Bind:function(){var e,t=document.getElementById(Grid.Id),n=t.firstChild;e=dataSource.length<100?dataSource.length:100;for(var i=0;e>i;i++){var a=n.rows.length,r=n.insertRow(a);$.each(columnData,function(e,t){var n=r.insertCell(e);t==ColmName?(n.innerHTML="<a href="+baseUrl+dataSource[i][SourceCol]+">"+dataSource[i][t]+"</a>",n.title=dataSource[i][t]):(n.innerHTML=dataSource[i][t],n.title=dataSource[i][t])})}return Grid.Pager(tableId,PageSize),Grid.init(),Grid.showPageNav("pager","pageNavPosition"),Grid.showPage(1),n.rows.length>=dataSource.length?(clearInterval(myVar),void(myVar=null)):void 0},SetHyperLink:function(e,t,n){baseUrl=t,SourceCol=n,ColmName=e},HyperLink:function(e,t,n,i){var a,r=document.getElementById(Grid.Id).firstChild.getElementsByTagName("th");$.each(r,function(e,n){if(n.innerHTML.trim()==SourceCol.trim()&&(a=n.cellIndex),n.innerHTML.trim()==ColmName.trim()){var r=document.getElementById(Grid.Id).firstChild.getElementsByTagName("tr");$.each(r,function(e,r){var o,l=r.cells,d=l[n.cellIndex].innerHTML;"th"!=l[n.cellIndex].localName&&(o=void 0!=a?"<a href="+t+l[a].innerHTML+">"+d+"</a>":"<a href="+t+i+">"+d+"</a>",l[n.cellIndex].innerHTML="",l[n.cellIndex].innerHTML=o)})}})},SetExportFileName:function(e){ReportTitle=e},ExportCSV:function(e,t,n){document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible";var i,a=dataSource;i="object"!=typeof a?JSON.parse(a):a;var r="";if(r+=ReportTitle+"\r\n\n",n){var o="";for(var l in i[0])o+=l+",";o=o.slice(0,-1),r+=o+"\r\n"}for(var d=0;d<i.length;d++){var o="";for(var l in i[d])o+='"'+i[d][l]+'",';o.slice(0,o.length-1),r+=o+"\r\n"}if(""==r)return void alert("Invalid data");var s=ReportTitle.replace(/ /g,"_"),c=("data:text/csv;charset=utf-8,"+escape(r),new Blob([r],{type:"text/csv"}));if(navigator.msSaveBlob)navigator.msSaveOrOpenBlob(c,s+".csv");else{var g=URL.createObjectURL(c);e.href=g,e.download=s+".csv"}document.getElementById("loadingImg").style.display="none",document.getElementById("loadingImg").style.visibility="hidden"},Pager:function(e,t){this.tableName=e,this.itemsPerPage=t,this.pages=0,this.inited=!1,this.showRecords=function(t,n){var i=document.getElementById(e).getElementsByTagName("tr");$.each(i,function(e,i){e>0&&(t>e||e>n?i.style.display="none":i.style.display="")})},this.showPage=function(e){if(!this.inited)return void alert("not inited");var n=document.getElementById("pg"+currentPage);(null!=n||void 0!=n)&&(n.className="pg-normal"),currentPage=e;var i=document.getElementById("pg"+currentPage);(null!=i||void 0!=i)&&(i.className="pg-selected");var a=(e-1)*t+1,r=a+t-1;this.showRecords(a,r)},this.prev=function(){currentPage>1&&(this.showPage(currentPage-1),document.getElementById("pgNum").innerHTML="",document.getElementById("pgNum").innerHTML=" Page Number: "+currentPage+" of "+Math.ceil(dataSource.length/t)+" <span> <span>  Total Records: "+dataSource.length+"</span></span>")},this.next=function(){if(document.getElementById("loadingImg").style.display="block",document.getElementById("loadingImg").style.visibility="visible",this.pages-currentPage<=3){var e=document.getElementById(Grid.Id),n=e.firstChild;addRow(Grid.Id,n.rows.length)}currentPage<this.pages&&this.showPage(currentPage+1),document.getElementById("pgNum").innerHTML="",document.getElementById("pgNum").innerHTML=" Page Number: "+currentPage+" of "+Math.ceil(dataSource.length/t)+" <span> <span>  Total Records: "+dataSource.length+"</span></span>",document.getElementById("loadingImg").style.display="none",document.getElementById("loadingImg").style.visibility="hidden"},this.init=function(){var n=document.getElementById(e).getElementsByTagName("tr"),i=n.length-1;this.pages=Math.ceil(i/t),this.inited=!0},this.showPageNav=function(e,n){if(!this.inited)return void alert("not inited");for(var i=document.getElementById(n),a='<span onclick="Grid.prev();" class="pg-normal"> &#171 Prev </span> | ',r=1;r<=this.pages;r++)a+='<span id="pg'+r+'" class="pg-normal" onclick="'+e+".showPage("+r+');"></span>  ';a+='<span onclick="Grid.next();" class="pg-normal"> Next &#187;</span>',i.innerHTML=a;i.innerHTML+='<span class="pg-normal" id="pgNum"> Page Number: '+currentPage+" of "+Math.ceil(dataSource.length/t)+"<span> <span >  Total Records: "+dataSource.length+"</span>"}},SetAjaxDetails:function(e,t,n){$.ajax({type:"POST",url:e,contentType:"application/json;charset=utf-8",dataType:"json",success:function(e){for(var t=document.getElementById(tId),n=t.firstChild,a=e.d,r=JSON.parse(a),o=n.rows.length,l=n.insertRow(o),d=0;d<columnData.length;d++){var s=l.insertCell(d);columnData[d]==ColmName?s.innerHTML="<a href="+baseUrl+r[i][SourceCol]+">"+r[i][columnData[d]]+"</a>":s.innerHTML=r[i][columnData[d]]}}})}};"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var sort_by=function(e,t,n){var i=n?function(t){return n(t[e])}:function(t){return t[e]};return t=t?-1:1,function(e,n){return e=i(e),n=i(n),t*((e>n)-(n>e))}};
